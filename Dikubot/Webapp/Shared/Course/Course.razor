@using Dikubot.Database.Models.Course
@using System.Globalization
@using Microsoft.AspNetCore.Mvc.Razor

<div class="course-editor" style="width: 90%;">
    <BFUTextField Label="Navn" Value="@CourseModel.Name" OnInput="change => CourseModel.Name = change" Placeholder="Kursus Navn"></BFUTextField>
    <BFUTextField Label="Område" Value="@CourseModel.Area" OnInput="change => CourseModel.Area = change" Placeholder="Study Board of Mathematics and Computer Science"></BFUTextField>
    <BFUTextField Label="Kursus Url" Value="@CourseModel.CourseUrl" OnInput="change => CourseModel.CourseUrl = change" Placeholder="https://kurser.ku.dk/course/ndak15006u/2020-2021"></BFUTextField>
    <BFUSlider Label="Antal Hold" Min="0" Max="30" Step="1.0" DefaultValue="@(CourseModel?.TeamCategoryIdList?.Length ?? 0)" ValueChanged="length => TeamLength = length"></BFUSlider>
    <BFUDatePicker Label="Start dato" Value="@CourseModel.StartDate" ValueChanged="change => CourseModel.StartDate = change" Placeholder="Start dato"></BFUDatePicker>
    <BFUDatePicker Label="Slut dato" Value="@CourseModel.EndDate" ValueChanged="change => CourseModel.EndDate = change" Placeholder="Slut dato"></BFUDatePicker>
    <BFUTextField Label="Gentages hvert n'ende år (f.eks. 1.0 for at ske en gang om året)" OnInput="ChangeRepeat" ErrorMessage="@RepeatErrorMessage" Placeholder="0.0"></BFUTextField>
                <BFUStack Horizontal="true" Style="margin-top: 10px;" Tokens=@(new BFUStackTokens() { ChildrenGap = new[] { 10.0 } })>
                    <BFUPrimaryButton Text="Bekræft Ændringer" OnClick=@(SubmitCourse) />
                    <BFUDefaultButton Text="Annulér" Style="background-color: lightcoral"/>
                </BFUStack>
</div>

@code {
    [Parameter] 
    public CourseModel CourseModel { get; set; }

    public double TeamLength;
    public double RepeatEveryNthYear;
    public string RepeatErrorMessage = "";

    public void ChangeRepeat(string value)
    {
        try
        {
            RepeatEveryNthYear = Convert.ToDouble(value);
            CourseModel.RepeatEveryNthYear = RepeatEveryNthYear;
            RepeatErrorMessage = "";
        }
        catch (Exception e)
        {
            RepeatErrorMessage = "Inputtet skal være et tal";
        }
        
    }

    public void SubmitCourse()
    {
        
    }
}