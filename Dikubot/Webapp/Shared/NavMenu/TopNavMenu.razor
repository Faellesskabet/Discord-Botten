@namespace Dikubot.Webapp.Extensions.NavMenu
@using Dikubot.Webapp.Authentication
@using Dikubot.Discord
@using global::Discord.WebSocket
@using Dikubot.DataLayer.Database.Global.GuildSettings
@using Dikubot.DataLayer.Database.Global.User
@using Dikubot.Webapp.Pages
@using MudBlazor.Utilities
@using Data
@using Dikubot.Extensions.EmojiSelector
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NotifyStateService _notifyStateService;
@inject UserService _user



<MudAppBar Elevation="1" Style="background-color: #231b2f">
    <MudHidden Breakpoint="Breakpoint.Xs" Invert="true">
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@ToggleDrawer"/>
        <MudSpacer/>
    </MudHidden>
    <MudButton Variant="Variant.Text"
               Href="/"> <MudText Typo="Typo.h5" Color="Color.Primary"> kuliv.dk</MudText></MudButton>
    
    <MudHidden Breakpoint="Breakpoint.SmAndUp" Invert="true">
        <MudButton Variant="Variant.Text"
                   Href="/discovery/unions"
                   Style="@NavTextStyleColor">
            <Localization>
                <Danish>
                    Foreninger
                </Danish>
                <English>
                    Associations
                </English>
            </Localization>
        </MudButton>
        <MudButton Variant="Variant.Text" Style="@NavTextStyleColor"
                   Href="/discovery/events">Events</MudButton>
        <MudButton Variant="Variant.Text"
                   Href="/discovery/calendar"
                   Style="@NavTextStyleColor">
            <Localization>
                <Danish>Kalender</Danish>
                <English>Calendar</English>
            </Localization>
        </MudButton>
    </MudHidden>
    <MudSpacer/>
    <MudButton Variant="Variant.Text" Style="@NavTextStyleColor"
               Href="/connect">
        <Localization>
            <Danish>Login</Danish>
            <English>Login</English>
        </Localization>
    </MudButton>
    <MudIconButton Size="Size.Medium" Color="Color.Inherit" Icon="@Icons.Filled.WbSunny" OnClick="() => App.DarkMode()"/> 
    <Localization>
        <Danish>
            <MudIconButton Size="Size.Large" Icon="@Twemoji.E1f1e9_1f1f0" OnClick="() => new ChangeLocalization(_user, _notifyStateService).Change(ChangeLocalization.Language.English)"/>
            </Danish>
        <English>
            <MudIconButton Size="Size.Large" Icon="@Twemoji.E1f1ec_1f1e7" OnClick="() => new ChangeLocalization(_user, _notifyStateService).Change(ChangeLocalization.Language.Danish)"/>
            </English>
    </Localization>
    <MudIconButton Icon="@Icons.Custom.Brands.GitHub" Color="Color.Inherit" Link="https://github.com/Faellesskabet/Discord-Botten" Target="_blank"/>

</MudAppBar>
       <MudDrawer @bind-Open="@open" Elevation="1" Variant="@DrawerVariant.Temporary">
           <MudDrawerHeader>
               <MudText Typo="Typo.h6" Color="Color.Primary" >KULiv.dk</MudText>
           </MudDrawerHeader>
           <MudNavMenu>
               <MudNavLink Match="NavLinkMatch.All" Href="/discovery/unions">Foreninger</MudNavLink>
               <MudNavLink Match="NavLinkMatch.All" Href="/discovery/events">Events</MudNavLink>
               <MudNavLink Match="NavLinkMatch.All" Href="/discovery/calendar">Kalender</MudNavLink>
           </MudNavMenu>
       </MudDrawer>


@code {
    
    bool open = false;
    private string NavColor => (string) (App.IsDarkMode ? App.ThemeManager.Theme.PaletteDark.AppbarBackground : App.ThemeManager.Theme.Palette.AppbarBackground);
    private string NavStyleColor => $"color: {NavColor}";
    
    private string NavTextColor => (string)(App.IsDarkMode ? App.ThemeManager.Theme.PaletteDark.AppbarText : App.ThemeManager.Theme.Palette.AppbarText);
    private string NavTextStyleColor => $"color: {NavTextColor}";
    
    private string DrawTextColor => (string)(App.IsDarkMode ? App.ThemeManager.Theme.PaletteDark.AppbarText : App.ThemeManager.Theme.Palette.AppbarText);
    private string DrawTextStyleColor => $"color: {DrawTextColor}";
    
    [Parameter]
    public App App { get; set; }

    protected override async Task OnInitializedAsync()
    {
        //NavColor = GetColor().Value;
        //NavTextColor = GetTextColor().Value;
    }

    void ToggleDrawer()
    {
        open = !open;
    }
    
    /*
    private MudColor GetColor()
    {
        return 
    }

    private MudColor GetTextColor()
    {
        return App.ThemeProvider.IsDarkMode ? App.ThemeProvider.Theme.PaletteDark.TextPrimary : App.ThemeProvider.Theme.Palette.TextPrimary;
    }
  */
}